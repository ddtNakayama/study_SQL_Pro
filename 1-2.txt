# 各県の行を列で取得する
SELECT
	# 性別
	sex,
	# すべてのレコードの人口を集計して取得する
	SUM(population) AS 全国,
	# 徳島のレコードの人口を取得する
	SUM(
		CASE
			WHEN pref_name = '徳島' THEN population
			ELSE 0
		END
	) AS 徳島,
	# 香川のレコードの人口を取得する
	SUM(
		CASE
			WHEN pref_name = '香川' THEN population
			ELSE 0
		END
	) AS 香川,
	# 愛媛のレコードの人口を取得する
	SUM(
		CASE
			WHEN pref_name = '愛媛' THEN population
			ELSE 0
		END
	) AS 愛媛,
	# 高知のレコードの人口を取得する
	SUM(
		CASE
			WHEN pref_name = '高知' THEN population
			ELSE 0
		END
	) AS 高知,
	# 四国のレコードの人口を取得する
	SUM(
		CASE
			WHEN pref_name IN ('徳島','香川','愛媛','高知') THEN population
			ELSE 0
		END
	) AS 四国
FROM PopTbl2
GROUP BY
	sex
;